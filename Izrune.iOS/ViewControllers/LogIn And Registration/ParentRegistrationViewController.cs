// This file has been autogenerated from a class added in the UI designer.

using System;
using System.Linq;
using Foundation;
using Izrune.iOS.Utils;
using MpdcViewExtentions;
using UIKit;

namespace Izrune.iOS
{
	public partial class ParentRegistrationViewController : UIViewController
	{
		public ParentRegistrationViewController (IntPtr handle) : base (handle)
		{
		}

        public static readonly NSString StoryboardId = new NSString("ParentRegistrationStoryboardId");

        UIViewController[] RegistrationPages;

        private bool isFirstPage = true;
        private ParentRegiFirstViewController parentRegVc;
        private ParentRegSecondViewController parent2RegVc;

        public override void ViewDidLoad()
        {
            base.ViewDidLoad();

            parentRegVc = Storyboard.InstantiateViewController(ParentRegiFirstViewController.StoryboardId) as ParentRegiFirstViewController;

            parent2RegVc = Storyboard.InstantiateViewController(ParentRegSecondViewController.StoryboardId) as ParentRegSecondViewController;


            this.AddVcInView(viewForPager, parentRegVc);
            //this.AddChildViewController(parentRegVc);

            //parentRegVc.View.Frame = new CoreGraphics.CGRect(0, 0, viewForPager.Frame.Width, viewForPager.Frame.Height);

            //viewForPager.AddSubview(parentRegVc.View);

            //parentRegVc.DidMoveToParentViewController(this);

            InitUI();

            InitGestures();
        }

        public override void ViewDidLayoutSubviews()
        {
            base.ViewDidLayoutSubviews();

            //RegistrationPages?[0].AddAsChildViewController(this, viewForPager);

        }

        private void InitGestures()
        {
            nextBtn.TouchUpInside += delegate
            {
                var count = this.ChildViewControllers.Length;
                isFirstPage = false;
                CheckIndex();
                AddSecondVc();
                count = this.ChildViewControllers.Length;
            };

            prewBtn.TouchUpInside += delegate {
                isFirstPage = true;
                CheckIndex();
                AddFirstVc();
            };
        }

        private void AddSecondVc()
        {
            parentRegVc.WillMoveToParentViewController(this);
            parentRegVc.View.RemoveFromSuperview();
            parentRegVc.RemoveFromParentViewController();

            this.AddVcInView(viewForPager, parent2RegVc);


            //this.AddChildViewController(parent2RegVc);

            //parent2RegVc.View.Frame = new CoreGraphics.CGRect(0, 0, viewForPager.Frame.Width, viewForPager.Frame.Height);

            //viewForPager.AddSubview(parent2RegVc.View);

            //parent2RegVc.DidMoveToParentViewController(this);
        }

        private void AddFirstVc()
        {
            parent2RegVc.WillMoveToParentViewController(this);
            parent2RegVc.View.RemoveFromSuperview();
            parent2RegVc.RemoveFromParentViewController();

            this.AddVcInView(viewForPager, parentRegVc);

            //this.AddChildViewController(parentRegVc);

            //parentRegVc.View.Frame = new CoreGraphics.CGRect(0, 0, viewForPager.Frame.Width, viewForPager.Frame.Height);

            //viewForPager.AddSubview(parentRegVc.View);

            //parentRegVc.DidMoveToParentViewController(this);

        }

        private void InitUI()
        {
            nextBtn.Layer.CornerRadius = 25;
            prewBtn.Layer.CornerRadius = 25;

            nextBtn.AddShadowToView(5, 25, 0.8f, AppColors.TitleColor);

            //userNameTextField.MakeRoundedTextField(20.0f, AppColors.TextFieldBackground, 17);

        }

        private void CheckIndex()
        {
            nextBtn.Enabled = isFirstPage;
            prewBtn.Enabled = !isFirstPage;
        }
    }
}
